{"ast":null,"code":"import _slicedToArray from\"/Users/javiercosio/Documents/ITC/tweet-react-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"../App.css\";import{useHistory}from\"react-router-dom\";import AppContext from\"../context/AppContext\";import{useContext,useState,useEffect}from\"react\";import firebase from\"../lib/firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Profile(){var appContext=useContext(AppContext);var history=useHistory();var _useState=useState(),_useState2=_slicedToArray(_useState,2),loginUserEmail=_useState2[0],setLoginUserEmail=_useState2[1];// const [loginUserDisplayName, setLoginUserDisplayName] = useState();\n// const [loginUserId, setLoginUserId] = useState();\nvar _useState3=useState(),_useState4=_slicedToArray(_useState3,2),loginUserPhotoURL=_useState4[0],setLoginUserPhotoURL=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),uploadedPhoto=_useState6[0],setUploadedPhoto=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),fileU=_useState8[0],setFileU=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),urlPic=_useState10[0],setUrlPic=_useState10[1];firebase.auth().onAuthStateChanged(function(user){if(user){// User is signed in, see docs for a list of available properties\n// https://firebase.google.com/docs/reference/js/firebase.User\nsetLoginUserEmail(user.email);// ...\n}else{// User is signed out\n// ...\nhistory.push(\"/login\");}if(user!==null){// console.log(\"Sign-in provider: \" + user.providerId);\n// console.log(\"  Provider-specific UID: \" + user.uid);\n// console.log(\"  Name: \" + user.displayName);\n// console.log(\"  Email: \" + user.email);\n// console.log(\"  Photo URL: \" + user.photoURL);\nappContext.setLoginUserDisplayName(user.displayName);appContext.setLoginUserId(user.uid);appContext.setUser(user.displayName);}});var handleProfilePicture=function handleProfilePicture(e){var file=e.target.files[0];setFileU(file);console.log(file.name);setUploadedPhoto(file.name);appContext.setUserInputFilled(true);};var handleChangeUser=function handleChangeUser(e){appContext.setUserInput(e.target.value);appContext.setUserInputFilled(true);};var handleUserSubmit=function handleUserSubmit(){//appContext.setUser(appContext.userInput);\nvar user=firebase.auth().currentUser;user.updateProfile({displayName:appContext.userInput,photoURL:appContext.loginUserId+\"/profilePicture/\"+uploadedPhoto}).then(function(){// Update successful\n// ...\nconsole.log(\"Update successful\");appContext.userInput&&appContext.setUser(appContext.userInput);}).catch(function(error){// An error occurred\n// ...\n});// Create a Storage Ref w/ username\nvar storageRef=firebase.storage().ref(appContext.loginUserId+\"/profilePic\");// Upload file\nvar task=storageRef.put(fileU);appContext.setUserInputFilled(false);history.push(\"/\");};// firebase\n//   .storage()\n//   .ref(appContext.loginUserId)\n//   //.child(appContext.loginUserId + \"/profilePicture/\" + uploadedPhoto)\n//   .getDownloadURL()\n//   .then((url) => {\n//     console.log(url);\n//   })\n//   .catch((error) => {\n//     // Handle any errors\n//   });\nif(!urlPic){var starsRef=firebase.storage().ref().child(appContext.loginUserId+\"/profilePic\");// Get the download URL\nstarsRef.getDownloadURL().then(function(url){// Insert url into an <img> tag to \"download\"\n//console.log(url)\nsetUrlPic(url);});}return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-wrapper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-left\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"img-cropper\",children:[urlPic&&/*#__PURE__*/_jsx(\"img\",{className:\"profile-img\",src:urlPic,alt:\"Profile Picture\"}),!urlPic&&/*#__PURE__*/_jsx(\"img\",{className:\"profile-img\",src:\"/blank-profile.svg\",alt:\"Profile Picture\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-title\",children:\"Profile\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-subtitle\",children:\"User Name\"}),!appContext.loginUserDisplayName&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"profile-input\",type:\"text\",onChange:handleChangeUser,placeholder:\"Create a username\"})}),appContext.loginUserDisplayName&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"profile-input\",type:\"text\",onChange:handleChangeUser,placeholder:appContext.loginUserDisplayName})}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-subtitle\",children:\"Email\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"profile-input\",type:\"text\",value:loginUserEmail})}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-subtitle\",children:\"Upload Profile's picture\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"myFile\",name:\"filename\",onChange:handleProfilePicture})}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-button-cotainer\",children:/*#__PURE__*/_jsx(\"button\",{disabled:!appContext.userInputFilled,className:\"submit-button-\".concat(!appContext.userInputFilled),onClick:handleUserSubmit,children:\"Save\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-right\"})]});}export default Profile;","map":{"version":3,"sources":["/Users/javiercosio/Documents/ITC/tweet-react-project/src/components/Profile.js"],"names":["useHistory","AppContext","useContext","useState","useEffect","firebase","Profile","appContext","history","loginUserEmail","setLoginUserEmail","loginUserPhotoURL","setLoginUserPhotoURL","uploadedPhoto","setUploadedPhoto","fileU","setFileU","urlPic","setUrlPic","auth","onAuthStateChanged","user","email","push","setLoginUserDisplayName","displayName","setLoginUserId","uid","setUser","handleProfilePicture","e","file","target","files","console","log","name","setUserInputFilled","handleChangeUser","setUserInput","value","handleUserSubmit","currentUser","updateProfile","userInput","photoURL","loginUserId","then","catch","error","storageRef","storage","ref","task","put","starsRef","child","getDownloadURL","url","loginUserDisplayName","userInputFilled"],"mappings":"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","sourcesContent":["import \"../App.css\";\nimport { useHistory } from \"react-router-dom\";\nimport AppContext from \"../context/AppContext\";\nimport { useContext, useState, useEffect } from \"react\";\nimport firebase from \"../lib/firebase\";\n\nfunction Profile() {\n  const appContext = useContext(AppContext);\n  const history = useHistory();\n\n  const [loginUserEmail, setLoginUserEmail] = useState();\n  // const [loginUserDisplayName, setLoginUserDisplayName] = useState();\n  // const [loginUserId, setLoginUserId] = useState();\n  const [loginUserPhotoURL, setLoginUserPhotoURL] = useState();\n  const [uploadedPhoto, setUploadedPhoto] = useState();\n  const [fileU, setFileU] = useState();\n  const [urlPic, setUrlPic] = useState();\n\n  firebase.auth().onAuthStateChanged((user) => {\n    if (user) {\n      // User is signed in, see docs for a list of available properties\n      // https://firebase.google.com/docs/reference/js/firebase.User\n      setLoginUserEmail(user.email);\n      // ...\n    } else {\n      // User is signed out\n      // ...\n      history.push(\"/login\");\n    }\n\n    if (user !== null) {\n      // console.log(\"Sign-in provider: \" + user.providerId);\n      // console.log(\"  Provider-specific UID: \" + user.uid);\n      // console.log(\"  Name: \" + user.displayName);\n      // console.log(\"  Email: \" + user.email);\n      // console.log(\"  Photo URL: \" + user.photoURL);\n      appContext.setLoginUserDisplayName(user.displayName);\n      appContext.setLoginUserId(user.uid);\n      appContext.setUser(user.displayName);\n    }\n  });\n\n  const handleProfilePicture = (e) => {\n    let file = e.target.files[0];\n    setFileU(file);\n    console.log(file.name);\n    setUploadedPhoto(file.name);\n    appContext.setUserInputFilled(true);\n  };\n\n  const handleChangeUser = (e) => {\n    appContext.setUserInput(e.target.value);\n    appContext.setUserInputFilled(true);\n  };\n\n  const handleUserSubmit = () => {\n    //appContext.setUser(appContext.userInput);\n\n    const user = firebase.auth().currentUser;\n    user\n      .updateProfile({\n        displayName: appContext.userInput,\n        photoURL: appContext.loginUserId + \"/profilePicture/\" + uploadedPhoto,\n      })\n      .then(() => {\n        // Update successful\n        // ...\n        console.log(\"Update successful\");\n        \n        appContext.userInput && appContext.setUser(appContext.userInput)\n      })\n      .catch((error) => {\n        // An error occurred\n        // ...\n      });\n\n    // Create a Storage Ref w/ username\n    let storageRef = firebase\n      .storage()\n      .ref(appContext.loginUserId + \"/profilePic\");\n\n    // Upload file\n    let task = storageRef.put(fileU);\n\n    appContext.setUserInputFilled(false);\n    history.push(\"/\");\n  };\n\n  // firebase\n  //   .storage()\n  //   .ref(appContext.loginUserId)\n  //   //.child(appContext.loginUserId + \"/profilePicture/\" + uploadedPhoto)\n  //   .getDownloadURL()\n  //   .then((url) => {\n  //     console.log(url);\n  //   })\n  //   .catch((error) => {\n  //     // Handle any errors\n  //   });\n\n  if (!urlPic) {\n    let starsRef = firebase\n      .storage()\n      .ref()\n      .child(appContext.loginUserId + \"/profilePic\");\n\n    // Get the download URL\n    starsRef.getDownloadURL().then((url) => {\n      // Insert url into an <img> tag to \"download\"\n      //console.log(url)\n      setUrlPic(url);\n    });\n  }\n\n  return (\n    <div className=\"profile-wrapper\">\n      <div className=\"profile-left\"></div>\n      <div className=\"profile-container\">\n        <div className=\"img-cropper\">\n          {urlPic && \n            <img\n              className=\"profile-img\"\n              src={urlPic}\n              alt=\"Profile Picture\"\n            ></img>\n          }\n          {!urlPic && \n            <img\n              className=\"profile-img\"\n              src=\"/blank-profile.svg\"\n              alt=\"Profile Picture\"\n            ></img>\n          }\n        </div>\n        <div className=\"profile-title\">Profile</div>\n        <div className=\"profile-subtitle\">User Name</div>\n        {!appContext.loginUserDisplayName && (\n          <div>\n            <input\n              className=\"profile-input\"\n              type=\"text\"\n              onChange={handleChangeUser}\n              placeholder=\"Create a username\"\n            />\n          </div>\n        )}\n        {appContext.loginUserDisplayName && (\n          <div>\n            <input\n              className=\"profile-input\"\n              type=\"text\"\n              onChange={handleChangeUser}\n              placeholder={appContext.loginUserDisplayName}\n            />\n          </div>\n        )}\n        <div className=\"profile-subtitle\">Email</div>\n        <div>\n          <input className=\"profile-input\" type=\"text\" value={loginUserEmail} />\n        </div>\n        <div className=\"profile-subtitle\">Upload Profile's picture</div>\n        <div>\n          <input\n            type=\"file\"\n            id=\"myFile\"\n            name=\"filename\"\n            onChange={handleProfilePicture}\n          />\n        </div>\n\n        <div className=\"profile-button-cotainer\">\n          <button\n            disabled={!appContext.userInputFilled}\n            className={`submit-button-${!appContext.userInputFilled}`}\n            onClick={handleUserSubmit}\n          >\n            Save\n          </button>\n        </div>\n      </div>\n      <div className=\"profile-right\"></div>\n    </div>\n  );\n}\n\nexport default Profile;\n"]},"metadata":{},"sourceType":"module"}